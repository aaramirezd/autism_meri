<?xml version="1.0"?>
<launch>
  <arg name="camera_name" default="kinect2_a"/>
  <arg name="recognition" default="true" /> 
  <arg name="device" default=""/>
  <arg name="channels" default="1"/>
  <arg name="sample_rate" default="16000"/>
  <arg name="format" default="mp3"/>
  <arg name="dst" default="$(find autism_meri)/$(arg camera_name)_output.mp3"/>
  <arg name="ns" default="audio"/>
  <arg name="record_audio" default="false"/>
  <arg name="FullPath" default="$(find autism_meri)/data/user.jpg"/>
  <arg name="box_size" default="250"/>
  
  
  <include file="$(find autism_meri)/launch/kinect2_bridge.launch">
    <arg name="base_name"    value="$(arg camera_name)" />
    <arg name="publish_tf"   value="true" />
    <arg name="output"       value="log" />
  </include>
  
  <!-- Launch calibration results -->
  <include file="$(find autism_meri)/launch/opt_calibration_results.launch"/>
  
  <include file="$(find autism_meri)/launch/focus_estimation.launch"/>
  
  <node pkg="autism_meri" type="init_child_image" name="init_image" output="screen">
      <remap from="/init_image/image" to="/$(arg camera_name)/hd/image_color_crop"/>
      <param name="FullPath" value="$(arg FullPath)"/>
      <param name="box_size" value="$(arg box_size)"/>
  </node>
    
  <group ns="tracker_$(arg camera_name)">
    <node pkg="autism_meri" type="face_tracking_estimation" name="Prueba1" output="screen">
      <param name="model_loc" value="-fx 1.0599465578241038e+03 -fy 1.0539326808799726e+03 -cx 4.7488326677588441e+02 -cy 2.6373858291060583e+02"/>
      <param name="parent_path" value="$(find autism_meri             )"/>
      <remap from="/tracker_$(arg camera_name)/image" to="/$(arg camera_name)/hd/image_color_crop"/>/
      <remap from="/tracker_$(arg camera_name)/odom" to="/tracker/odom"/>
    </node>
  </group>
  
  <node pkg="autism_meri" type="global_pose_estimation" name="global_estimation" output="screen">
    <remap from="/global_estimation/input" to="/local_pose"/>
    <remap from="/global_estimation/output" to="/global_pose"/>
  </node>

  <group ns="$(arg ns)">
    <node if="$(arg record_audio)" name="audio_capture" pkg="audio_capture" type="audio_capture" output="screen">
      <param name="bitrate" value="128"/>
      <param name="device" value="$(arg device)"/>
      <param name="channels" value="$(arg channels)"/>
      <param name="sample_rate" value="$(arg sample_rate)"/>
      <param name="format" value="$(arg format)"/>
      <param name="dst" value="$(arg dst)"/>
    </node>
  </group>

</launch>


